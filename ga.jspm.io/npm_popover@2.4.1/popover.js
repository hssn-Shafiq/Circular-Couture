import t from"domify";import o from"debounce";import i from"emitter-component";var e={};var s=t;var r=o;var n=i;var h='<div class="popover"><div class="popover-arrow"></div><div class="popover-content"></div></div>';e=Popover;function Popover(t){if(!(this instanceof Popover))return new Popover(t);n.call(this);this.opts=t||{};this.el=s("string"===typeof t.template?t.template:h);var o=this.opts.className?this.opts.className.split(" "):[];o.forEach((function(t){this.el.classList.add(t)}),this);t.button&&this.setButton(this.opts.button)}n(Popover.prototype);Popover.prototype.show=Popover.prototype.render=function(t){var o=this;document.body.appendChild(this.el);this.opts.position=this.opts.position||"right";this.position(this.opts.position);requestAnimationFrame((function(){o.el.classList.add(t||"show");o.emit("shown")}));this._listenOnResize();return this};Popover.prototype.destroy=Popover.prototype.remove=function(){this.button=null;this.el.parentNode.removeChild(this.el);this.emit("removed");this.off();window.removeEventListener("resize",this._resizeListener,false)};Popover.prototype.setContent=function(t){t="string"===typeof t?s(t):t;this.el.querySelector(".popover-content").appendChild(t);return this};Popover.prototype.setButton=function(t){t="string"===typeof t?document.querySelector(t):t;this.button=t;this.buttonCoords=this.button.getBoundingClientRect();return this};Popover.prototype.position=function(t){var o,i;this.el.classList.add("popover-"+t);this._rect=this.el.getBoundingClientRect();if("top"===t||"bottom"===t){o=this._calculateX();i="top"===t?this.buttonCoords.top-this._rect.height:this.buttonCoords.top+this.buttonCoords.height;this.el.style[this.opts.align||"left"]=o+(window.scrollX||window.pageXOffset)+"px";this.el.style.top=i+(window.scrollY||window.pageYOffset)+"px";this._positionArrow("left",this.el.getBoundingClientRect().left)}if("right"===t||"left"===t){o="right"===t?this.buttonCoords.left+this.buttonCoords.width:this.buttonCoords.left-this._rect.width;i=this._calculateY();this.el.style.left=o+(window.scrollX||window.pageXOffset)+"px";this.el.style.top=i+(window.scrollY||window.pageYOffset)+"px";this._positionArrow("top",i)}return this};Popover.prototype._listenOnResize=function(){var t=this;this._resizeListener=r((function(){t.buttonCoords=t.button.getBoundingClientRect();t.position(t.opts.position)}),100);window.addEventListener("resize",this._resizeListener,false)};Popover.prototype._positionArrow=function(t,o){var i=this.el.querySelector(".popover-arrow");if(i){var e="top"===t?"height":"width";var s=this.buttonCoords[t]+this.buttonCoords[e]/2-o;i.style[t]=Math.round(s)+"px"}};Popover.prototype._calculateY=function(){this._rect||(this._rect=this.el.getBoundingClientRect());var t=this._rect.height;var o=this.buttonCoords.top+(this.buttonCoords.height-t)/2;this._autoAlign(o);"top"===this.opts.align&&(o=this.buttonCoords.top);return o};Popover.prototype._calculateX=function(){this._rect||(this._rect=this.el.getBoundingClientRect());var t=this._rect.width;var o=this.buttonCoords.left+(this.buttonCoords.width-t)/2;this._autoAlign(o);"left"===this.opts.align&&(o=this.buttonCoords.left);"right"===this.opts.align&&(o=window.innerWidth-(this.buttonCoords.left+this.buttonCoords.width));return o};Popover.prototype._autoAlign=function(t){this._rect||(this._rect=this.el.getBoundingClientRect());var o=this._rect.width;var i=this.opts.position;var e="top"===i||"bottom"===i;e&&t+o>window.innerWidth&&(this.opts.align="right");e&&t<0&&(this.opts.align="left");!e&&t<0&&(this.opts.align="top");return this};var p=e;export default p;

//# sourceMappingURL=popover.js.map