import t from"jquery";var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var i={};(function(e,i){i(t)})(i,(function(t){t=t&&t.hasOwnProperty("default")?t["default"]:t;function _typeof(t){_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||false;a.configurable=true;"value"in a&&(a.writable=true);Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){e&&_defineProperties(t.prototype,e);i&&_defineProperties(t,i);return t}function _defineProperty(t,e,i){e in t?Object.defineProperty(t,e,{value:i,enumerable:true,configurable:true,writable:true}):t[e]=i;return t}function ownKeys(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})));i.push.apply(i,a)}return i}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(i,true).forEach((function(e){_defineProperty(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var i="undefined"!==typeof window&&"undefined"!==typeof window.document;var a=i?window:{};var r=!!i&&"ontouchstart"in a.document.documentElement;var n=!!i&&"PointerEvent"in a;var s="cropper";var o="all";var h="crop";var c="move";var l="zoom";var d="e";var p="w";var u="s";var f="n";var v="ne";var m="nw";var g="se";var b="sw";var w="".concat(s,"-crop");var y="".concat(s,"-disabled");var x="".concat(s,"-hidden");var C="".concat(s,"-hide");var D="".concat(s,"-invisible");var M="".concat(s,"-modal");var N="".concat(s,"-move");var O="".concat(s,"Action");var E="".concat(s,"Preview");var B="crop";var T="move";var L="none";var k="crop";var z="cropend";var S="cropmove";var j="cropstart";var W="dblclick";var A=r?"touchstart":"mousedown";var H=r?"touchmove":"mousemove";var R=r?"touchend touchcancel":"mouseup";var P=n?"pointerdown":A;var Y=n?"pointermove":H;var X=n?"pointerup pointercancel":R;var I="ready";var U="resize";var _="wheel";var F="zoom";var q="image/jpeg";var K=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/;var $=/^data:/;var Q=/^data:image\/jpeg;base64,/;var Z=/^img|canvas$/i;var G=200;var V=100;var J={viewMode:0,dragMode:B,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};var tt='<div class="cropper-container" touch-action="none">'+'<div class="cropper-wrap-box">'+'<div class="cropper-canvas"></div>'+"</div>"+'<div class="cropper-drag-box"></div>'+'<div class="cropper-crop-box">'+'<span class="cropper-view-box"></span>'+'<span class="cropper-dashed dashed-h"></span>'+'<span class="cropper-dashed dashed-v"></span>'+'<span class="cropper-center"></span>'+'<span class="cropper-face"></span>'+'<span class="cropper-line line-e" data-cropper-action="e"></span>'+'<span class="cropper-line line-n" data-cropper-action="n"></span>'+'<span class="cropper-line line-w" data-cropper-action="w"></span>'+'<span class="cropper-line line-s" data-cropper-action="s"></span>'+'<span class="cropper-point point-e" data-cropper-action="e"></span>'+'<span class="cropper-point point-n" data-cropper-action="n"></span>'+'<span class="cropper-point point-w" data-cropper-action="w"></span>'+'<span class="cropper-point point-s" data-cropper-action="s"></span>'+'<span class="cropper-point point-ne" data-cropper-action="ne"></span>'+'<span class="cropper-point point-nw" data-cropper-action="nw"></span>'+'<span class="cropper-point point-sw" data-cropper-action="sw"></span>'+'<span class="cropper-point point-se" data-cropper-action="se"></span>'+"</div>"+"</div>";var et=Number.isNaN||a.isNaN;function isNumber(t){return"number"===typeof t&&!et(t)}var it=function isPositiveNumber(t){return t>0&&t<Infinity};function isUndefined(t){return"undefined"===typeof t}function isObject(t){return"object"===_typeof(t)&&null!==t}var at=Object.prototype.hasOwnProperty;function isPlainObject(t){if(!isObject(t))return false;try{var e=t.constructor;var i=e.prototype;return e&&i&&at.call(i,"isPrototypeOf")}catch(t){return false}}function isFunction(t){return"function"===typeof t}var rt=Array.prototype.slice;function toArray(t){return Array.from?Array.from(t):rt.call(t)}function forEach(t,e){t&&isFunction(e)&&(Array.isArray(t)||isNumber(t.length)?toArray(t).forEach((function(i,a){e.call(t,i,a,t)})):isObject(t)&&Object.keys(t).forEach((function(i){e.call(t,t[i],i,t)})));return t}var nt=Object.assign||function assign(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];isObject(t)&&i.length>0&&i.forEach((function(e){isObject(e)&&Object.keys(e).forEach((function(i){t[i]=e[i]}))}));return t};var st=/\.\d*(?:0|9){12}\d*$/;function normalizeDecimalNumber(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return st.test(t)?Math.round(t*e)/e:t}var ot=/^width|height|left|top|marginLeft|marginTop$/;function setStyle(t,e){var i=t.style;forEach(e,(function(t,e){ot.test(e)&&isNumber(t)&&(t="".concat(t,"px"));i[e]=t}))}function hasClass(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function addClass(t,e){if(e)if(isNumber(t.length))forEach(t,(function(t){addClass(t,e)}));else if(t.classList)t.classList.add(e);else{var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function removeClass(t,e){e&&(isNumber(t.length)?forEach(t,(function(t){removeClass(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function toggleClass(t,e,i){e&&(isNumber(t.length)?forEach(t,(function(t){toggleClass(t,e,i)})):i?addClass(t,e):removeClass(t,e))}var ht=/([a-z\d])([A-Z])/g;function toParamCase(t){return t.replace(ht,"$1-$2").toLowerCase()}function getData(t,e){return isObject(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(toParamCase(e)))}function setData(t,e,i){isObject(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(toParamCase(e)),i)}function removeData(t,e){if(isObject(t[e]))try{delete t[e]}catch(i){t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch(i){t.dataset[e]=void 0}else t.removeAttribute("data-".concat(toParamCase(e)))}var ct=/\s\s*/;var lt=function(){var t=false;if(i){var e=false;var r=function listener(){};var n=Object.defineProperty({},"once",{get:function get(){t=true;return e},set:function set(t){e=t}});a.addEventListener("test",r,n);a.removeEventListener("test",r,n)}return t}();function removeListener(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var r=i;e.trim().split(ct).forEach((function(e){if(!lt){var n=t.listeners;if(n&&n[e]&&n[e][i]){r=n[e][i];delete n[e][i];0===Object.keys(n[e]).length&&delete n[e];0===Object.keys(n).length&&delete t.listeners}}t.removeEventListener(e,r,a)}))}function addListener(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var r=i;e.trim().split(ct).forEach((function(e){if(a.once&&!lt){var n=t.listeners,s=void 0===n?{}:n;r=function handler(){delete s[e][i];t.removeEventListener(e,r,a);for(var n=arguments.length,o=new Array(n),h=0;h<n;h++)o[h]=arguments[h];i.apply(t,o)};s[e]||(s[e]={});s[e][i]&&t.removeEventListener(e,s[e][i],a);s[e][i]=r;t.listeners=s}t.addEventListener(e,r,a)}))}function dispatchEvent(t,e,i){var a;if(isFunction(Event)&&isFunction(CustomEvent))a=new CustomEvent(e,{detail:i,bubbles:true,cancelable:true});else{a=document.createEvent("CustomEvent");a.initCustomEvent(e,true,true,i)}return t.dispatchEvent(a)}function getOffset(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var dt=a.location;var pt=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function isCrossOriginURL(t){var e=t.match(pt);return null!==e&&(e[1]!==dt.protocol||e[2]!==dt.hostname||e[3]!==dt.port)}function addTimestamp(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function getTransforms(t){var e=t.rotate,i=t.scaleX,a=t.scaleY,r=t.translateX,n=t.translateY;var s=[];isNumber(r)&&0!==r&&s.push("translateX(".concat(r,"px)"));isNumber(n)&&0!==n&&s.push("translateY(".concat(n,"px)"));isNumber(e)&&0!==e&&s.push("rotate(".concat(e,"deg)"));isNumber(i)&&1!==i&&s.push("scaleX(".concat(i,")"));isNumber(a)&&1!==a&&s.push("scaleY(".concat(a,")"));var o=s.length?s.join(" "):"none";return{WebkitTransform:o,msTransform:o,transform:o}}function getMaxZoomRatio(t){var e=_objectSpread2({},t);var i=[];forEach(t,(function(t,a){delete e[a];forEach(e,(function(e){var a=Math.abs(t.startX-e.startX);var r=Math.abs(t.startY-e.startY);var n=Math.abs(t.endX-e.endX);var s=Math.abs(t.endY-e.endY);var o=Math.sqrt(a*a+r*r);var h=Math.sqrt(n*n+s*s);var c=(h-o)/o;i.push(c)}))}));i.sort((function(t,e){return Math.abs(t)<Math.abs(e)}));return i[0]}function getPointer(t,e){var i=t.pageX,a=t.pageY;var r={endX:i,endY:a};return e?r:_objectSpread2({startX:i,startY:a},r)}function getPointersCenter(t){var e=0;var i=0;var a=0;forEach(t,(function(t){var r=t.startX,n=t.startY;e+=r;i+=n;a+=1}));e/=a;i/=a;return{pageX:e,pageY:i}}function getAdjustedSizes(t){var e=t.aspectRatio,i=t.height,a=t.width;var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain";var n=it(a);var s=it(i);if(n&&s){var o=i*e;"contain"===r&&o>a||"cover"===r&&o<a?i=a/e:a=i*e}else n?i=a/e:s&&(a=i*e);return{width:a,height:i}}function getRotatedSizes(t){var e=t.width,i=t.height,a=t.degree;a=Math.abs(a)%180;if(90===a)return{width:i,height:e};var r=a%90*Math.PI/180;var n=Math.sin(r);var s=Math.cos(r);var o=e*s+i*n;var h=e*n+i*s;return a>90?{width:h,height:o}:{width:o,height:h}}function getSourceCanvas(t,e,i,a){var r=e.aspectRatio,n=e.naturalWidth,s=e.naturalHeight,o=e.rotate,h=void 0===o?0:o,c=e.scaleX,l=void 0===c?1:c,d=e.scaleY,p=void 0===d?1:d;var u=i.aspectRatio,f=i.naturalWidth,v=i.naturalHeight;var m=a.fillColor,g=void 0===m?"transparent":m,b=a.imageSmoothingEnabled,w=void 0===b||b,y=a.imageSmoothingQuality,x=void 0===y?"low":y,C=a.maxWidth,D=void 0===C?Infinity:C,M=a.maxHeight,N=void 0===M?Infinity:M,O=a.minWidth,E=void 0===O?0:O,B=a.minHeight,T=void 0===B?0:B;var L=document.createElement("canvas");var k=L.getContext("2d");var z=getAdjustedSizes({aspectRatio:u,width:D,height:N});var S=getAdjustedSizes({aspectRatio:u,width:E,height:T},"cover");var j=Math.min(z.width,Math.max(S.width,f));var W=Math.min(z.height,Math.max(S.height,v));var A=getAdjustedSizes({aspectRatio:r,width:D,height:N});var H=getAdjustedSizes({aspectRatio:r,width:E,height:T},"cover");var R=Math.min(A.width,Math.max(H.width,n));var P=Math.min(A.height,Math.max(H.height,s));var Y=[-R/2,-P/2,R,P];L.width=normalizeDecimalNumber(j);L.height=normalizeDecimalNumber(W);k.fillStyle=g;k.fillRect(0,0,j,W);k.save();k.translate(j/2,W/2);k.rotate(h*Math.PI/180);k.scale(l,p);k.imageSmoothingEnabled=w;k.imageSmoothingQuality=x;k.drawImage.apply(k,[t].concat(_toConsumableArray(Y.map((function(t){return Math.floor(normalizeDecimalNumber(t))})))));k.restore();return L}var ut=String.fromCharCode;function getStringFromCharCode(t,e,i){var a="";i+=e;for(var r=e;r<i;r+=1)a+=ut(t.getUint8(r));return a}var ft=/^data:.*,/;function dataURLToArrayBuffer(t){var e=t.replace(ft,"");var i=atob(e);var a=new ArrayBuffer(i.length);var r=new Uint8Array(a);forEach(r,(function(t,e){r[e]=i.charCodeAt(e)}));return a}function arrayBufferToDataURL(t,e){var i=[];var a=8192;var r=new Uint8Array(t);while(r.length>0){i.push(ut.apply(null,toArray(r.subarray(0,a))));r=r.subarray(a)}return"data:".concat(e,";base64,").concat(btoa(i.join("")))}function resetAndGetOrientation(t){var e=new DataView(t);var i;try{var a;var r;var n;if(255===e.getUint8(0)&&216===e.getUint8(1)){var s=e.byteLength;var o=2;while(o+1<s){if(255===e.getUint8(o)&&225===e.getUint8(o+1)){r=o;break}o+=1}}if(r){var h=r+4;var c=r+10;if("Exif"===getStringFromCharCode(e,h,4)){var l=e.getUint16(c);a=18761===l;if((a||19789===l)&&42===e.getUint16(c+2,a)){var d=e.getUint32(c+4,a);d>=8&&(n=c+d)}}}if(n){var p=e.getUint16(n,a);var u;var f;for(f=0;f<p;f+=1){u=n+12*f+2;if(274===e.getUint16(u,a)){u+=8;i=e.getUint16(u,a);e.setUint16(u,1,a);break}}}}catch(t){i=1}return i}function parseOrientation(t){var e=0;var i=1;var a=1;switch(t){case 2:i=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90;a=-1;break;case 6:e=90;break;case 7:e=90;i=-1;break;case 8:e=-90;break;default:}return{rotate:e,scaleX:i,scaleY:a}}var vt={render:function render(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();(this||e).cropped&&this.renderCropBox()},initContainer:function initContainer(){var t=(this||e).element,i=(this||e).options,a=(this||e).container,r=(this||e).cropper;addClass(r,x);removeClass(t,x);var n={width:Math.max(a.offsetWidth,Number(i.minContainerWidth)||200),height:Math.max(a.offsetHeight,Number(i.minContainerHeight)||100)};(this||e).containerData=n;setStyle(r,{width:n.width,height:n.height});addClass(t,x);removeClass(r,x)},initCanvas:function initCanvas(){var t=(this||e).containerData,i=(this||e).imageData;var a=(this||e).options.viewMode;var r=Math.abs(i.rotate)%180===90;var n=r?i.naturalHeight:i.naturalWidth;var s=r?i.naturalWidth:i.naturalHeight;var o=n/s;var h=t.width;var c=t.height;t.height*o>t.width?3===a?h=t.height*o:c=t.width/o:3===a?c=t.width/o:h=t.height*o;var l={aspectRatio:o,naturalWidth:n,naturalHeight:s,width:h,height:c};l.left=(t.width-h)/2;l.top=(t.height-c)/2;l.oldLeft=l.left;l.oldTop=l.top;(this||e).canvasData=l;(this||e).limited=1===a||2===a;this.limitCanvas(true,true);(this||e).initialImageData=nt({},i);(this||e).initialCanvasData=nt({},l)},limitCanvas:function limitCanvas(t,i){var a=(this||e).options,r=(this||e).containerData,n=(this||e).canvasData,s=(this||e).cropBoxData;var o=a.viewMode;var h=n.aspectRatio;var c=(this||e).cropped&&s;if(t){var l=Number(a.minCanvasWidth)||0;var d=Number(a.minCanvasHeight)||0;if(o>1){l=Math.max(l,r.width);d=Math.max(d,r.height);3===o&&(d*h>l?l=d*h:d=l/h)}else if(o>0)if(l)l=Math.max(l,c?s.width:0);else if(d)d=Math.max(d,c?s.height:0);else if(c){l=s.width;d=s.height;d*h>l?l=d*h:d=l/h}var p=getAdjustedSizes({aspectRatio:h,width:l,height:d});l=p.width;d=p.height;n.minWidth=l;n.minHeight=d;n.maxWidth=Infinity;n.maxHeight=Infinity}if(i)if(o>(c?0:1)){var u=r.width-n.width;var f=r.height-n.height;n.minLeft=Math.min(0,u);n.minTop=Math.min(0,f);n.maxLeft=Math.max(0,u);n.maxTop=Math.max(0,f);if(c&&(this||e).limited){n.minLeft=Math.min(s.left,s.left+(s.width-n.width));n.minTop=Math.min(s.top,s.top+(s.height-n.height));n.maxLeft=s.left;n.maxTop=s.top;if(2===o){if(n.width>=r.width){n.minLeft=Math.min(0,u);n.maxLeft=Math.max(0,u)}if(n.height>=r.height){n.minTop=Math.min(0,f);n.maxTop=Math.max(0,f)}}}}else{n.minLeft=-n.width;n.minTop=-n.height;n.maxLeft=r.width;n.maxTop=r.height}},renderCanvas:function renderCanvas(t,i){var a=(this||e).canvasData,r=(this||e).imageData;if(i){var n=getRotatedSizes({width:r.naturalWidth*Math.abs(r.scaleX||1),height:r.naturalHeight*Math.abs(r.scaleY||1),degree:r.rotate||0}),s=n.width,o=n.height;var h=a.width*(s/a.naturalWidth);var c=a.height*(o/a.naturalHeight);a.left-=(h-a.width)/2;a.top-=(c-a.height)/2;a.width=h;a.height=c;a.aspectRatio=s/o;a.naturalWidth=s;a.naturalHeight=o;this.limitCanvas(true,false)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft);(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop);a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth);a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight);this.limitCanvas(false,true);a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft);a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop);a.oldLeft=a.left;a.oldTop=a.top;setStyle((this||e).canvas,nt({width:a.width,height:a.height},getTransforms({translateX:a.left,translateY:a.top})));this.renderImage(t);(this||e).cropped&&(this||e).limited&&this.limitCropBox(true,true)},renderImage:function renderImage(t){var i=(this||e).canvasData,a=(this||e).imageData;var r=a.naturalWidth*(i.width/i.naturalWidth);var n=a.naturalHeight*(i.height/i.naturalHeight);nt(a,{width:r,height:n,left:(i.width-r)/2,top:(i.height-n)/2});setStyle((this||e).image,nt({width:a.width,height:a.height},getTransforms(nt({translateX:a.left,translateY:a.top},a))));t&&this.output()},initCropBox:function initCropBox(){var t=(this||e).options,i=(this||e).canvasData;var a=t.aspectRatio||t.initialAspectRatio;var r=Number(t.autoCropArea)||.8;var n={width:i.width,height:i.height};a&&(i.height*a>i.width?n.height=n.width/a:n.width=n.height*a);(this||e).cropBoxData=n;this.limitCropBox(true,true);n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth);n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight);n.width=Math.max(n.minWidth,n.width*r);n.height=Math.max(n.minHeight,n.height*r);n.left=i.left+(i.width-n.width)/2;n.top=i.top+(i.height-n.height)/2;n.oldLeft=n.left;n.oldTop=n.top;(this||e).initialCropBoxData=nt({},n)},limitCropBox:function limitCropBox(t,i){var a=(this||e).options,r=(this||e).containerData,n=(this||e).canvasData,s=(this||e).cropBoxData,o=(this||e).limited;var h=a.aspectRatio;if(t){var c=Number(a.minCropBoxWidth)||0;var l=Number(a.minCropBoxHeight)||0;var d=o?Math.min(r.width,n.width,n.width+n.left,r.width-n.left):r.width;var p=o?Math.min(r.height,n.height,n.height+n.top,r.height-n.top):r.height;c=Math.min(c,r.width);l=Math.min(l,r.height);if(h){c&&l?l*h>c?l=c/h:c=l*h:c?l=c/h:l&&(c=l*h);p*h>d?p=d/h:d=p*h}s.minWidth=Math.min(c,d);s.minHeight=Math.min(l,p);s.maxWidth=d;s.maxHeight=p}if(i)if(o){s.minLeft=Math.max(0,n.left);s.minTop=Math.max(0,n.top);s.maxLeft=Math.min(r.width,n.left+n.width)-s.width;s.maxTop=Math.min(r.height,n.top+n.height)-s.height}else{s.minLeft=0;s.minTop=0;s.maxLeft=r.width-s.width;s.maxTop=r.height-s.height}},renderCropBox:function renderCropBox(){var t=(this||e).options,i=(this||e).containerData,a=(this||e).cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft);(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop);a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth);a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight);this.limitCropBox(false,true);a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft);a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop);a.oldLeft=a.left;a.oldTop=a.top;t.movable&&t.cropBoxMovable&&setData((this||e).face,O,a.width>=i.width&&a.height>=i.height?c:o);setStyle((this||e).cropBox,nt({width:a.width,height:a.height},getTransforms({translateX:a.left,translateY:a.top})));(this||e).cropped&&(this||e).limited&&this.limitCanvas(true,true);(this||e).disabled||this.output()},output:function output(){this.preview();dispatchEvent((this||e).element,k,this.getData())}};var mt={initPreview:function initPreview(){var t=(this||e).element,i=(this||e).crossOrigin;var a=(this||e).options.preview;var r=i?(this||e).crossOriginUrl:(this||e).url;var n=t.alt||"The image to preview";var s=document.createElement("img");i&&(s.crossOrigin=i);s.src=r;s.alt=n;(this||e).viewBox.appendChild(s);(this||e).viewBoxImage=s;if(a){var o=a;"string"===typeof a?o=t.ownerDocument.querySelectorAll(a):a.querySelector&&(o=[a]);(this||e).previews=o;forEach(o,(function(t){var e=document.createElement("img");setData(t,E,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML});i&&(e.crossOrigin=i);e.src=r;e.alt=n;e.style.cssText="display:block;"+"width:100%;"+"height:auto;"+"min-width:0!important;"+"min-height:0!important;"+"max-width:none!important;"+"max-height:none!important;"+'image-orientation:0deg!important;"';t.innerHTML="";t.appendChild(e)}))}},resetPreview:function resetPreview(){forEach((this||e).previews,(function(t){var e=getData(t,E);setStyle(t,{width:e.width,height:e.height});t.innerHTML=e.html;removeData(t,E)}))},preview:function preview(){var t=(this||e).imageData,i=(this||e).canvasData,a=(this||e).cropBoxData;var r=a.width,n=a.height;var s=t.width,o=t.height;var h=a.left-i.left-t.left;var c=a.top-i.top-t.top;if((this||e).cropped&&!(this||e).disabled){setStyle((this||e).viewBoxImage,nt({width:s,height:o},getTransforms(nt({translateX:-h,translateY:-c},t))));forEach((this||e).previews,(function(e){var i=getData(e,E);var a=i.width;var l=i.height;var d=a;var p=l;var u=1;if(r){u=a/r;p=n*u}if(n&&p>l){u=l/n;d=r*u;p=l}setStyle(e,{width:d,height:p});setStyle(e.getElementsByTagName("img")[0],nt({width:s*u,height:o*u},getTransforms(nt({translateX:-h*u,translateY:-c*u},t))))}))}}};var gt={bind:function bind(){var t=(this||e).element,i=(this||e).options,a=(this||e).cropper;isFunction(i.cropstart)&&addListener(t,j,i.cropstart);isFunction(i.cropmove)&&addListener(t,S,i.cropmove);isFunction(i.cropend)&&addListener(t,z,i.cropend);isFunction(i.crop)&&addListener(t,k,i.crop);isFunction(i.zoom)&&addListener(t,F,i.zoom);addListener(a,P,(this||e).onCropStart=(this||e).cropStart.bind(this||e));i.zoomable&&i.zoomOnWheel&&addListener(a,_,(this||e).onWheel=(this||e).wheel.bind(this||e),{passive:false,capture:true});i.toggleDragModeOnDblclick&&addListener(a,W,(this||e).onDblclick=(this||e).dblclick.bind(this||e));addListener(t.ownerDocument,Y,(this||e).onCropMove=(this||e).cropMove.bind(this||e));addListener(t.ownerDocument,X,(this||e).onCropEnd=(this||e).cropEnd.bind(this||e));i.responsive&&addListener(window,U,(this||e).onResize=(this||e).resize.bind(this||e))},unbind:function unbind(){var t=(this||e).element,i=(this||e).options,a=(this||e).cropper;isFunction(i.cropstart)&&removeListener(t,j,i.cropstart);isFunction(i.cropmove)&&removeListener(t,S,i.cropmove);isFunction(i.cropend)&&removeListener(t,z,i.cropend);isFunction(i.crop)&&removeListener(t,k,i.crop);isFunction(i.zoom)&&removeListener(t,F,i.zoom);removeListener(a,P,(this||e).onCropStart);i.zoomable&&i.zoomOnWheel&&removeListener(a,_,(this||e).onWheel,{passive:false,capture:true});i.toggleDragModeOnDblclick&&removeListener(a,W,(this||e).onDblclick);removeListener(t.ownerDocument,Y,(this||e).onCropMove);removeListener(t.ownerDocument,X,(this||e).onCropEnd);i.responsive&&removeListener(window,U,(this||e).onResize)}};var bt={resize:function resize(){var t=(this||e).options,i=(this||e).container,a=(this||e).containerData;var r=Number(t.minContainerWidth)||G;var n=Number(t.minContainerHeight)||V;if(!((this||e).disabled||a.width<=r||a.height<=n)){var s=i.offsetWidth/a.width;if(1!==s||i.offsetHeight!==a.height){var o;var h;if(t.restore){o=this.getCanvasData();h=this.getCropBoxData()}this.render();if(t.restore){this.setCanvasData(forEach(o,(function(t,e){o[e]=t*s})));this.setCropBoxData(forEach(h,(function(t,e){h[e]=t*s})))}}}},dblclick:function dblclick(){(this||e).disabled||(this||e).options.dragMode===L||this.setDragMode(hasClass((this||e).dragBox,w)?T:B)},wheel:function wheel(t){var i=this||e;var a=Number((this||e).options.wheelZoomRatio)||.1;var r=1;if(!(this||e).disabled){t.preventDefault();if(!(this||e).wheeling){(this||e).wheeling=true;setTimeout((function(){i.wheeling=false}),50);t.deltaY?r=t.deltaY>0?1:-1:t.wheelDelta?r=-t.wheelDelta/120:t.detail&&(r=t.detail>0?1:-1);this.zoom(-r*a,t)}}},cropStart:function cropStart(t){var i=t.buttons,a=t.button;if(!((this||e).disabled||("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(isNumber(i)&&1!==i||isNumber(a)&&0!==a||t.ctrlKey))){var r=(this||e).options,n=(this||e).pointers;var s;t.changedTouches?forEach(t.changedTouches,(function(t){n[t.identifier]=getPointer(t)})):n[t.pointerId||0]=getPointer(t);s=Object.keys(n).length>1&&r.zoomable&&r.zoomOnTouch?l:getData(t.target,O);if(K.test(s)&&false!==dispatchEvent((this||e).element,j,{originalEvent:t,action:s})){t.preventDefault();(this||e).action=s;(this||e).cropping=false;if(s===h){(this||e).cropping=true;addClass((this||e).dragBox,M)}}}},cropMove:function cropMove(t){var i=(this||e).action;if(!(this||e).disabled&&i){var a=(this||e).pointers;t.preventDefault();if(false!==dispatchEvent((this||e).element,S,{originalEvent:t,action:i})){t.changedTouches?forEach(t.changedTouches,(function(t){nt(a[t.identifier]||{},getPointer(t,true))})):nt(a[t.pointerId||0]||{},getPointer(t,true));this.change(t)}}},cropEnd:function cropEnd(t){if(!(this||e).disabled){var i=(this||e).action,a=(this||e).pointers;t.changedTouches?forEach(t.changedTouches,(function(t){delete a[t.identifier]})):delete a[t.pointerId||0];if(i){t.preventDefault();Object.keys(a).length||((this||e).action="");if((this||e).cropping){(this||e).cropping=false;toggleClass((this||e).dragBox,M,(this||e).cropped&&(this||e).options.modal)}dispatchEvent((this||e).element,z,{originalEvent:t,action:i})}}}};var wt={change:function change(t){var i=(this||e).options,a=(this||e).canvasData,r=(this||e).containerData,n=(this||e).cropBoxData,s=(this||e).pointers;var w=(this||e).action;var y=i.aspectRatio;var C=n.left,D=n.top,M=n.width,N=n.height;var O=C+M;var E=D+N;var B=0;var T=0;var L=r.width;var k=r.height;var z=true;var S;!y&&t.shiftKey&&(y=M&&N?M/N:1);if((this||e).limited){B=n.minLeft;T=n.minTop;L=B+Math.min(r.width,a.width,a.left+a.width);k=T+Math.min(r.height,a.height,a.top+a.height)}var j=s[Object.keys(s)[0]];var W={x:j.endX-j.startX,y:j.endY-j.startY};var A=function check(t){switch(t){case d:O+W.x>L&&(W.x=L-O);break;case p:C+W.x<B&&(W.x=B-C);break;case f:D+W.y<T&&(W.y=T-D);break;case u:E+W.y>k&&(W.y=k-E);break;default:}};switch(w){case o:C+=W.x;D+=W.y;break;case d:if(W.x>=0&&(O>=L||y&&(D<=T||E>=k))){z=false;break}A(d);M+=W.x;if(M<0){w=p;M=-M;C-=M}if(y){N=M/y;D+=(n.height-N)/2}break;case f:if(W.y<=0&&(D<=T||y&&(C<=B||O>=L))){z=false;break}A(f);N-=W.y;D+=W.y;if(N<0){w=u;N=-N;D-=N}if(y){M=N*y;C+=(n.width-M)/2}break;case p:if(W.x<=0&&(C<=B||y&&(D<=T||E>=k))){z=false;break}A(p);M-=W.x;C+=W.x;if(M<0){w=d;M=-M;C-=M}if(y){N=M/y;D+=(n.height-N)/2}break;case u:if(W.y>=0&&(E>=k||y&&(C<=B||O>=L))){z=false;break}A(u);N+=W.y;if(N<0){w=f;N=-N;D-=N}if(y){M=N*y;C+=(n.width-M)/2}break;case v:if(y){if(W.y<=0&&(D<=T||O>=L)){z=false;break}A(f);N-=W.y;D+=W.y;M=N*y}else{A(f);A(d);W.x>=0?O<L?M+=W.x:W.y<=0&&D<=T&&(z=false):M+=W.x;if(W.y<=0){if(D>T){N-=W.y;D+=W.y}}else{N-=W.y;D+=W.y}}if(M<0&&N<0){w=b;N=-N;M=-M;D-=N;C-=M}else if(M<0){w=m;M=-M;C-=M}else if(N<0){w=g;N=-N;D-=N}break;case m:if(y){if(W.y<=0&&(D<=T||C<=B)){z=false;break}A(f);N-=W.y;D+=W.y;M=N*y;C+=n.width-M}else{A(f);A(p);if(W.x<=0)if(C>B){M-=W.x;C+=W.x}else W.y<=0&&D<=T&&(z=false);else{M-=W.x;C+=W.x}if(W.y<=0){if(D>T){N-=W.y;D+=W.y}}else{N-=W.y;D+=W.y}}if(M<0&&N<0){w=g;N=-N;M=-M;D-=N;C-=M}else if(M<0){w=v;M=-M;C-=M}else if(N<0){w=b;N=-N;D-=N}break;case b:if(y){if(W.x<=0&&(C<=B||E>=k)){z=false;break}A(p);M-=W.x;C+=W.x;N=M/y}else{A(u);A(p);if(W.x<=0)if(C>B){M-=W.x;C+=W.x}else W.y>=0&&E>=k&&(z=false);else{M-=W.x;C+=W.x}W.y>=0?E<k&&(N+=W.y):N+=W.y}if(M<0&&N<0){w=v;N=-N;M=-M;D-=N;C-=M}else if(M<0){w=g;M=-M;C-=M}else if(N<0){w=m;N=-N;D-=N}break;case g:if(y){if(W.x>=0&&(O>=L||E>=k)){z=false;break}A(d);M+=W.x;N=M/y}else{A(u);A(d);W.x>=0?O<L?M+=W.x:W.y>=0&&E>=k&&(z=false):M+=W.x;W.y>=0?E<k&&(N+=W.y):N+=W.y}if(M<0&&N<0){w=m;N=-N;M=-M;D-=N;C-=M}else if(M<0){w=b;M=-M;C-=M}else if(N<0){w=v;N=-N;D-=N}break;case c:this.move(W.x,W.y);z=false;break;case l:this.zoom(getMaxZoomRatio(s),t);z=false;break;case h:if(!W.x||!W.y){z=false;break}S=getOffset((this||e).cropper);C=j.startX-S.left;D=j.startY-S.top;M=n.minWidth;N=n.minHeight;if(W.x>0)w=W.y>0?g:v;else if(W.x<0){C-=M;w=W.y>0?b:m}W.y<0&&(D-=N);if(!(this||e).cropped){removeClass((this||e).cropBox,x);(this||e).cropped=true;(this||e).limited&&this.limitCropBox(true,true)}break;default:}if(z){n.width=M;n.height=N;n.left=C;n.top=D;(this||e).action=w;this.renderCropBox()}forEach(s,(function(t){t.startX=t.endX;t.startY=t.endY}))}};var yt={crop:function crop(){if((this||e).ready&&!(this||e).cropped&&!(this||e).disabled){(this||e).cropped=true;this.limitCropBox(true,true);(this||e).options.modal&&addClass((this||e).dragBox,M);removeClass((this||e).cropBox,x);this.setCropBoxData((this||e).initialCropBoxData)}return this||e},reset:function reset(){if((this||e).ready&&!(this||e).disabled){(this||e).imageData=nt({},(this||e).initialImageData);(this||e).canvasData=nt({},(this||e).initialCanvasData);(this||e).cropBoxData=nt({},(this||e).initialCropBoxData);this.renderCanvas();(this||e).cropped&&this.renderCropBox()}return this||e},clear:function clear(){if((this||e).cropped&&!(this||e).disabled){nt((this||e).cropBoxData,{left:0,top:0,width:0,height:0});(this||e).cropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();removeClass((this||e).dragBox,M);addClass((this||e).cropBox,x)}return this||e},replace:function replace(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(this||e).disabled&&t){(this||e).isImg&&((this||e).element.src=t);if(i){(this||e).url=t;(this||e).image.src=t;if((this||e).ready){(this||e).viewBoxImage.src=t;forEach((this||e).previews,(function(e){e.getElementsByTagName("img")[0].src=t}))}}else{(this||e).isImg&&((this||e).replaced=true);(this||e).options.data=null;this.uncreate();this.load(t)}}return this||e},enable:function enable(){if((this||e).ready&&(this||e).disabled){(this||e).disabled=false;removeClass((this||e).cropper,y)}return this||e},disable:function disable(){if((this||e).ready&&!(this||e).disabled){(this||e).disabled=true;addClass((this||e).cropper,y)}return this||e},destroy:function destroy(){var t=(this||e).element;if(!t[s])return this||e;t[s]=void 0;(this||e).isImg&&(this||e).replaced&&(t.src=(this||e).originalUrl);this.uncreate();return this||e},move:function move(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;var a=(this||e).canvasData,r=a.left,n=a.top;return this.moveTo(isUndefined(t)?t:r+Number(t),isUndefined(i)?i:n+Number(i))},moveTo:function moveTo(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;var a=(this||e).canvasData;var r=false;t=Number(t);i=Number(i);if((this||e).ready&&!(this||e).disabled&&(this||e).options.movable){if(isNumber(t)){a.left=t;r=true}if(isNumber(i)){a.top=i;r=true}r&&this.renderCanvas(true)}return this||e},zoom:function zoom(t,i){var a=(this||e).canvasData;t=Number(t);t=t<0?1/(1-t):1+t;return this.zoomTo(a.width*t/a.naturalWidth,null,i)},zoomTo:function zoomTo(t,i,a){var r=(this||e).options,n=(this||e).canvasData;var s=n.width,o=n.height,h=n.naturalWidth,c=n.naturalHeight;t=Number(t);if(t>=0&&(this||e).ready&&!(this||e).disabled&&r.zoomable){var l=h*t;var d=c*t;if(false===dispatchEvent((this||e).element,F,{ratio:t,oldRatio:s/h,originalEvent:a}))return this||e;if(a){var p=(this||e).pointers;var u=getOffset((this||e).cropper);var f=p&&Object.keys(p).length?getPointersCenter(p):{pageX:a.pageX,pageY:a.pageY};n.left-=(l-s)*((f.pageX-u.left-n.left)/s);n.top-=(d-o)*((f.pageY-u.top-n.top)/o)}else if(isPlainObject(i)&&isNumber(i.x)&&isNumber(i.y)){n.left-=(l-s)*((i.x-n.left)/s);n.top-=(d-o)*((i.y-n.top)/o)}else{n.left-=(l-s)/2;n.top-=(d-o)/2}n.width=l;n.height=d;this.renderCanvas(true)}return this||e},rotate:function rotate(t){return this.rotateTo(((this||e).imageData.rotate||0)+Number(t))},rotateTo:function rotateTo(t){t=Number(t);if(isNumber(t)&&(this||e).ready&&!(this||e).disabled&&(this||e).options.rotatable){(this||e).imageData.rotate=t%360;this.renderCanvas(true,true)}return this||e},scaleX:function scaleX(t){var i=(this||e).imageData.scaleY;return this.scale(t,isNumber(i)?i:1)},scaleY:function scaleY(t){var i=(this||e).imageData.scaleX;return this.scale(isNumber(i)?i:1,t)},scale:function scale(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;var a=(this||e).imageData;var r=false;t=Number(t);i=Number(i);if((this||e).ready&&!(this||e).disabled&&(this||e).options.scalable){if(isNumber(t)){a.scaleX=t;r=true}if(isNumber(i)){a.scaleY=i;r=true}r&&this.renderCanvas(true,true)}return this||e},getData:function getData(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var i=(this||e).options,a=(this||e).imageData,r=(this||e).canvasData,n=(this||e).cropBoxData;var s;if((this||e).ready&&(this||e).cropped){s={x:n.left-r.left,y:n.top-r.top,width:n.width,height:n.height};var o=a.width/a.naturalWidth;forEach(s,(function(t,e){s[e]=t/o}));if(t){var h=Math.round(s.y+s.height);var c=Math.round(s.x+s.width);s.x=Math.round(s.x);s.y=Math.round(s.y);s.width=c-s.x;s.height=h-s.y}}else s={x:0,y:0,width:0,height:0};i.rotatable&&(s.rotate=a.rotate||0);if(i.scalable){s.scaleX=a.scaleX||1;s.scaleY=a.scaleY||1}return s},setData:function setData(t){var i=(this||e).options,a=(this||e).imageData,r=(this||e).canvasData;var n={};if((this||e).ready&&!(this||e).disabled&&isPlainObject(t)){var s=false;if(i.rotatable&&isNumber(t.rotate)&&t.rotate!==a.rotate){a.rotate=t.rotate;s=true}if(i.scalable){if(isNumber(t.scaleX)&&t.scaleX!==a.scaleX){a.scaleX=t.scaleX;s=true}if(isNumber(t.scaleY)&&t.scaleY!==a.scaleY){a.scaleY=t.scaleY;s=true}}s&&this.renderCanvas(true,true);var o=a.width/a.naturalWidth;isNumber(t.x)&&(n.left=t.x*o+r.left);isNumber(t.y)&&(n.top=t.y*o+r.top);isNumber(t.width)&&(n.width=t.width*o);isNumber(t.height)&&(n.height=t.height*o);this.setCropBoxData(n)}return this||e},getContainerData:function getContainerData(){return(this||e).ready?nt({},(this||e).containerData):{}},getImageData:function getImageData(){return(this||e).sized?nt({},(this||e).imageData):{}},getCanvasData:function getCanvasData(){var t=(this||e).canvasData;var i={};(this||e).ready&&forEach(["left","top","width","height","naturalWidth","naturalHeight"],(function(e){i[e]=t[e]}));return i},setCanvasData:function setCanvasData(t){var i=(this||e).canvasData;var a=i.aspectRatio;if((this||e).ready&&!(this||e).disabled&&isPlainObject(t)){isNumber(t.left)&&(i.left=t.left);isNumber(t.top)&&(i.top=t.top);if(isNumber(t.width)){i.width=t.width;i.height=t.width/a}else if(isNumber(t.height)){i.height=t.height;i.width=t.height*a}this.renderCanvas(true)}return this||e},getCropBoxData:function getCropBoxData(){var t=(this||e).cropBoxData;var i;(this||e).ready&&(this||e).cropped&&(i={left:t.left,top:t.top,width:t.width,height:t.height});return i||{}},setCropBoxData:function setCropBoxData(t){var i=(this||e).cropBoxData;var a=(this||e).options.aspectRatio;var r;var n;if((this||e).ready&&(this||e).cropped&&!(this||e).disabled&&isPlainObject(t)){isNumber(t.left)&&(i.left=t.left);isNumber(t.top)&&(i.top=t.top);if(isNumber(t.width)&&t.width!==i.width){r=true;i.width=t.width}if(isNumber(t.height)&&t.height!==i.height){n=true;i.height=t.height}a&&(r?i.height=i.width/a:n&&(i.width=i.height*a));this.renderCropBox()}return this||e},getCroppedCanvas:function getCroppedCanvas(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(this||e).ready||!window.HTMLCanvasElement)return null;var i=(this||e).canvasData;var a=getSourceCanvas((this||e).image,(this||e).imageData,i,t);if(!(this||e).cropped)return a;var r=this.getData(),n=r.x,s=r.y,o=r.width,h=r.height;var c=a.width/Math.floor(i.naturalWidth);if(1!==c){n*=c;s*=c;o*=c;h*=c}var l=o/h;var d=getAdjustedSizes({aspectRatio:l,width:t.maxWidth||Infinity,height:t.maxHeight||Infinity});var p=getAdjustedSizes({aspectRatio:l,width:t.minWidth||0,height:t.minHeight||0},"cover");var u=getAdjustedSizes({aspectRatio:l,width:t.width||(1!==c?a.width:o),height:t.height||(1!==c?a.height:h)}),f=u.width,v=u.height;f=Math.min(d.width,Math.max(p.width,f));v=Math.min(d.height,Math.max(p.height,v));var m=document.createElement("canvas");var g=m.getContext("2d");m.width=normalizeDecimalNumber(f);m.height=normalizeDecimalNumber(v);g.fillStyle=t.fillColor||"transparent";g.fillRect(0,0,f,v);var b=t.imageSmoothingEnabled,w=void 0===b||b,y=t.imageSmoothingQuality;g.imageSmoothingEnabled=w;y&&(g.imageSmoothingQuality=y);var x=a.width;var C=a.height;var D=n;var M=s;var N;var O;var E;var B;var T;var L;if(D<=-o||D>x){D=0;N=0;E=0;T=0}else if(D<=0){E=-D;D=0;N=Math.min(x,o+D);T=N}else if(D<=x){E=0;N=Math.min(o,x-D);T=N}if(N<=0||M<=-h||M>C){M=0;O=0;B=0;L=0}else if(M<=0){B=-M;M=0;O=Math.min(C,h+M);L=O}else if(M<=C){B=0;O=Math.min(h,C-M);L=O}var k=[D,M,N,O];if(T>0&&L>0){var z=f/o;k.push(E*z,B*z,T*z,L*z)}g.drawImage.apply(g,[a].concat(_toConsumableArray(k.map((function(t){return Math.floor(normalizeDecimalNumber(t))})))));return m},setAspectRatio:function setAspectRatio(t){var i=(this||e).options;if(!(this||e).disabled&&!isUndefined(t)){i.aspectRatio=Math.max(0,t)||NaN;if((this||e).ready){this.initCropBox();(this||e).cropped&&this.renderCropBox()}}return this||e},setDragMode:function setDragMode(t){var i=(this||e).options,a=(this||e).dragBox,r=(this||e).face;if((this||e).ready&&!(this||e).disabled){var n=t===B;var s=i.movable&&t===T;t=n||s?t:L;i.dragMode=t;setData(a,O,t);toggleClass(a,w,n);toggleClass(a,N,s);if(!i.cropBoxMovable){setData(r,O,t);toggleClass(r,w,n);toggleClass(r,N,s)}}return this||e}};var xt=a.Cropper;var Ct=function(){function Cropper(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this||e,Cropper);if(!t||!Z.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");(this||e).element=t;(this||e).options=nt({},J,isPlainObject(i)&&i);(this||e).cropped=false;(this||e).disabled=false;(this||e).pointers={};(this||e).ready=false;(this||e).reloading=false;(this||e).replaced=false;(this||e).sized=false;(this||e).sizing=false;this.init()}_createClass(Cropper,[{key:"init",value:function init(){var t=(this||e).element;var i=t.tagName.toLowerCase();var a;if(!t[s]){t[s]=this||e;if("img"===i){(this||e).isImg=true;a=t.getAttribute("src")||"";(this||e).originalUrl=a;if(!a)return;a=t.src}else"canvas"===i&&window.HTMLCanvasElement&&(a=t.toDataURL());this.load(a)}}},{key:"load",value:function load(t){var i=this||e;if(t){(this||e).url=t;(this||e).imageData={};var a=(this||e).element,r=(this||e).options;r.rotatable||r.scalable||(r.checkOrientation=false);if(r.checkOrientation&&window.ArrayBuffer)if($.test(t))Q.test(t)?this.read(dataURLToArrayBuffer(t)):this.clone();else{var n=new XMLHttpRequest;var s=(this||e).clone.bind(this||e);(this||e).reloading=true;(this||e).xhr=n;n.onabort=s;n.onerror=s;n.ontimeout=s;n.onprogress=function(){n.getResponseHeader("content-type")!==q&&n.abort()};n.onload=function(){i.read(n.response)};n.onloadend=function(){i.reloading=false;i.xhr=null};r.checkCrossOrigin&&isCrossOriginURL(t)&&a.crossOrigin&&(t=addTimestamp(t));n.open("GET",t);n.responseType="arraybuffer";n.withCredentials="use-credentials"===a.crossOrigin;n.send()}else this.clone()}}},{key:"read",value:function read(t){var i=(this||e).options,a=(this||e).imageData;var r=resetAndGetOrientation(t);var n=0;var s=1;var o=1;if(r>1){(this||e).url=arrayBufferToDataURL(t,q);var h=parseOrientation(r);n=h.rotate;s=h.scaleX;o=h.scaleY}i.rotatable&&(a.rotate=n);if(i.scalable){a.scaleX=s;a.scaleY=o}this.clone()}},{key:"clone",value:function clone(){var t=(this||e).element,i=(this||e).url;var a=t.crossOrigin;var r=i;if((this||e).options.checkCrossOrigin&&isCrossOriginURL(i)){a||(a="anonymous");r=addTimestamp(i)}(this||e).crossOrigin=a;(this||e).crossOriginUrl=r;var n=document.createElement("img");a&&(n.crossOrigin=a);n.src=r||i;n.alt=t.alt||"The image to crop";(this||e).image=n;n.onload=(this||e).start.bind(this||e);n.onerror=(this||e).stop.bind(this||e);addClass(n,C);t.parentNode.insertBefore(n,t.nextSibling)}},{key:"start",value:function start(){var t=this||e;var i=(this||e).image;i.onload=null;i.onerror=null;(this||e).sizing=true;var r=a.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(a.navigator.userAgent);var n=function done(e,i){nt(t.imageData,{naturalWidth:e,naturalHeight:i,aspectRatio:e/i});t.sizing=false;t.sized=true;t.build()};if(!i.naturalWidth||r){var s=document.createElement("img");var o=document.body||document.documentElement;(this||e).sizingImage=s;s.onload=function(){n(s.width,s.height);r||o.removeChild(s)};s.src=i.src;if(!r){s.style.cssText="left:0;"+"max-height:none!important;"+"max-width:none!important;"+"min-height:0!important;"+"min-width:0!important;"+"opacity:0;"+"position:absolute;"+"top:0;"+"z-index:-1;";o.appendChild(s)}}else n(i.naturalWidth,i.naturalHeight)}},{key:"stop",value:function stop(){var t=(this||e).image;t.onload=null;t.onerror=null;t.parentNode.removeChild(t);(this||e).image=null}},{key:"build",value:function build(){if((this||e).sized&&!(this||e).ready){var t=(this||e).element,i=(this||e).options,a=(this||e).image;var r=t.parentNode;var n=document.createElement("div");n.innerHTML=tt;var h=n.querySelector(".".concat(s,"-container"));var c=h.querySelector(".".concat(s,"-canvas"));var l=h.querySelector(".".concat(s,"-drag-box"));var d=h.querySelector(".".concat(s,"-crop-box"));var p=d.querySelector(".".concat(s,"-face"));(this||e).container=r;(this||e).cropper=h;(this||e).canvas=c;(this||e).dragBox=l;(this||e).cropBox=d;(this||e).viewBox=h.querySelector(".".concat(s,"-view-box"));(this||e).face=p;c.appendChild(a);addClass(t,x);r.insertBefore(h,t.nextSibling);(this||e).isImg||removeClass(a,C);this.initPreview();this.bind();i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN;i.aspectRatio=Math.max(0,i.aspectRatio)||NaN;i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0;addClass(d,x);i.guides||addClass(d.getElementsByClassName("".concat(s,"-dashed")),x);i.center||addClass(d.getElementsByClassName("".concat(s,"-center")),x);i.background&&addClass(h,"".concat(s,"-bg"));i.highlight||addClass(p,D);if(i.cropBoxMovable){addClass(p,N);setData(p,O,o)}if(!i.cropBoxResizable){addClass(d.getElementsByClassName("".concat(s,"-line")),x);addClass(d.getElementsByClassName("".concat(s,"-point")),x)}this.render();(this||e).ready=true;this.setDragMode(i.dragMode);i.autoCrop&&this.crop();this.setData(i.data);isFunction(i.ready)&&addListener(t,I,i.ready,{once:true});dispatchEvent(t,I)}}},{key:"unbuild",value:function unbuild(){if((this||e).ready){(this||e).ready=false;this.unbind();this.resetPreview();(this||e).cropper.parentNode.removeChild((this||e).cropper);removeClass((this||e).element,x)}}},{key:"uncreate",value:function uncreate(){if((this||e).ready){this.unbuild();(this||e).ready=false;(this||e).cropped=false}else if((this||e).sizing){(this||e).sizingImage.onload=null;(this||e).sizing=false;(this||e).sized=false}else if((this||e).reloading){(this||e).xhr.onabort=null;(this||e).xhr.abort()}else(this||e).image&&this.stop()}}],[{key:"noConflict",value:function noConflict(){window.Cropper=xt;return Cropper}},{key:"setDefaults",value:function setDefaults(t){nt(J,isPlainObject(t)&&t)}}]);return Cropper}();nt(Ct.prototype,vt,mt,gt,bt,wt,yt);if(t.fn){var Dt=t.fn.cropper;var Mt="cropper";t.fn.cropper=function jQueryCropper(i){for(var a=arguments.length,r=new Array(a>1?a-1:0),n=1;n<a;n++)r[n-1]=arguments[n];var s;this.each((function(e,a){var n=t(a);var o="destroy"===i;var h=n.data(Mt);if(!h){if(o)return;var c=t.extend({},n.data(),t.isPlainObject(i)&&i);h=new Ct(a,c);n.data(Mt,h)}if("string"===typeof i){var l=h[i];if(t.isFunction(l)){s=l.apply(h,r);s===h&&(s=void 0);o&&n.removeData(Mt)}}}));return void 0!==s?s:this||e};t.fn.cropper.Constructor=Ct;t.fn.cropper.setDefaults=Ct.setDefaults;t.fn.cropper.noConflict=function noConflict(){t.fn.cropper=Dt;return this||e}}}));export default i;

//# sourceMappingURL=cropper.js.map